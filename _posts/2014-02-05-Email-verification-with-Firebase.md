---
layout: post
title: Email verification with Firebase
categories: 
  - Web
tags: 
  - js
  - firebase
published: true
---

I'm working on a small web application (at the moment it is only a hobby project for learning reasons) 
using [AngularJS](http://www.angularjs.com) and [Firebase](http://www.firebase.com).

### Briefly on Firebase and why I'm using it

The main reason I chose Firebase for this is because it allows me to create this application without writing any
server code. Normally when I create an application with database access and user authentication I have to write a 
server layer and get a server to host it. But with Firebase I can write the whole thing in JavaScript instead!

This is great because:
- Faster since I don't have to write as much code
- I don't need to pay for a server, but can instead use free services like [GitHub Pages](http://pages.github.com/), 
[Kissr](http://www.kissr.com/), or similar.

It is also quite limiting of course. The server layer can do a lot more than just database access and user authentication, 
which Firebase can't handle. But for this application it will do everything I need.

### What Firebase Simple Login can do

The "Firebase Simple Login" API allows me to
- Create the user account using email and password. 
- Sign users in using email and password
- Send a password reset email to users
- Delete user accounts
from the JavaScript code. 

### What Firebase Simple Login can't do

Unfortunately, Firebase Simple Login does not offer email verification when a user signs up. I'd like to verify the email
to make sure the user didn't make a typo (reseting the password won't work if they do) as well as guard against bots.

### How I solved it

It was actually quite easy and works well.

#### Create the account

When creating a new account, Firebase expect an email and a password. 
I allow the user to enter only the email and instead generate a temporary password. 

Code for generating a password:
{% highlight javascript linenos %}
  function () {
    var possibleChars = ['abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!?_-'];
    var password = '';
    for(var i = 0; i < 16; i += 1) {
      password += possibleChars[Math.floor(Math.random() * possibleChars.length)];
    }
    return password;
  }
{% endhighlight %}

#### Reset the password

After the account is created I trigger the password reset function which will send an email to the user with a 
link back to my site. The link contains the temporary token generated by Firebase and is valid for 24 hours.

I ask the user to confirm his/her email (because there is no way for me to get the email address from the password reset email as far as I know) and pick a new password. Once the user's password has been changed to the new one he/she is ready to login as usual.

**Done!**